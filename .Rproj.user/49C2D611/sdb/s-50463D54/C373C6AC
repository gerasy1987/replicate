{
    "collab_server" : "",
    "contents" : "#' Summary method for replication class\n#'\n#' FUNCTION DESCRIPTION\n#'\n#' @param object DESCRIPTION.\n#' @param table DESCRIPTION.\n#' @param reported DESCRIPTION.\n#' @param registered DESCRIPTION.\n#' @param script DESCRIPTION.\n#' @param desc DESCRIPTION.\n#' @param ... DESCRIPTION.\n#'\n#' @return RETURN DESCRIPTION\n#' @examples\n#' # ADD EXAMPLES HERE\n#'\n#' @export\n\nsummary.replication <- function(object,\n                                table = NULL,\n                                reported = FALSE,\n                                registered = FALSE,\n                                script = FALSE,\n                                desc = NULL,\n                                ...) {\n  if (is.null(table) & !script) {\n    out <- attr(x = object, which = \"misc\")\n\n    structure(out, class = c(\"summary.replication\"))\n  } else if (!is.null(table) & !script & any(reported, registered)) {\n    table_name <- paste0(unlist(strsplit(x = tolower(table), split = \" \")), collapse = \"_\")\n\n    attach(environment(object))\n    out <- eval(parse(text = object$tables[[table_name]]))\n    rep <- reg <- NULL\n    if (reported) rep <- which(do.call(cbind, out[\"model_status\",])[\"P\",])\n    if (registered) reg <- which(do.call(cbind, out[\"model_status\",])[\"R\",])\n\n    out <- list(\"Reported\" = out[,rep],\n                \"Registered\" = out[,reg])\n    attr(out, which = \"name\") <- table\n    detach(environment(object))\n\n    structure(out, class = c(\"summary.replication\", \"replication.table\"))\n  } else if (script & !any(reported, registered)) {\n    script_preamble <-\n      paste(\"############\\n## This is preamble code.\\n## Run it before the replication of your first table in the study.\\n############\",\n            paste0(\"ipak <- \", paste0(deparse(ipak), collapse = \"\\n\")),\n            paste0(\"ipak(\", paste0(deparse(object$packages), collapse = \"\"), \")\"),\n            paste(do.call(c, object$functions), collapse = \"\\n\\n\"),\n            sep = \"\\n\\n\")\n    if (is.null(table)) {\n      out <- c(preamble = script_preamble)\n    } else {\n      table_name <- paste0(unlist(strsplit(x = tolower(table), split = \" \")), collapse = \"_\")\n      out <- c(preamble = script_preamble,\n               table = paste0(\"############\\n## Below is the table replication code\\n############\\n\\n\",\n                              table_name, \" <- \", object$tables[[table_name]],\n                              \"\\n\\n\", table_name))\n    }\n    structure(out, class = c(\"summary.replication\", \"replication.script\"))\n  }\n}\n\n#' @export\nprint.summary.replication <- function(x, ...) {\n  if (\"replication.table\" %in% class(x)) {\n    class(x) <- \"list\"\n    cat(\"Results for\", attr(x, which = \"name\"), \"\\n\\n\")\n    for (i in 1:length(x)) {\n      if (length(x[[i]]) != 0) {\n        cat(names(x)[i], \":\\n\\n\")\n        for (j in (1:dim(x[[i]])[2])){\n          cat(colnames(x[[i]])[j],\"\\n\\n\")\n          print(x[[i]][[\"estimates\",j]])\n          cat(\"\\n\")\n          stats_specs <- c(x[[i]][[\"stat\",j]],x[[i]][[\"model_spec\",j]])\n          cat(paste(paste0(names(stats_specs), \" = \", stats_specs), collapse = \", \"), \"\\n\\n\")\n        }\n      }\n    }\n    invisible(x)\n  } else if (\"replication.script\" %in% class(x)) {\n    class(x) <- \"character\"\n    cat(x, sep = \"\\n\\n\")\n    invisible(x)\n  } else {\n    class(x) <- \"list\"\n    cat(unlist(x))\n    invisible(x)\n  }\n}\n\n\n",
    "created" : 1470547829453.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "2973949389",
    "id" : "C373C6AC",
    "lastKnownWriteTime" : 1470549235,
    "last_content_update" : 1470549235420,
    "path" : "~/Google Drive/7 - Projects/replicate/R/summary.R",
    "project_path" : "R/summary.R",
    "properties" : {
        "chunk_rendered_width" : "650"
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_source"
}